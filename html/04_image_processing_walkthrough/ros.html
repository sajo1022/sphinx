<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ROS2 &mdash; Image Processing 03/2022 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utils function description (docstrings)" href="utils.html" />
    <link rel="prev" title="Fitting stone localization module" href="fitting_stone.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Image Processing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Project &quot;MauRob40&quot;</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01_project_introduction/project_introduction.html">Project description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_project_introduction/project_introduction.html#image-processing-goal">Image processing goal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_project_introduction/project_introduction.html#framework-requirements">Framework requirements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image processing basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_image_processing_basics/image_processing_objects.html">Image processing “objects”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_image_processing_basics/image_processing_operations.html">Image processing operations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_getting_started/getting_started.html">GitLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_getting_started/getting_started.html#prerequisites">Prerequisites</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image processing walkthrough</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="project_structure.html">Project structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Config module</a></li>
<li class="toctree-l1"><a class="reference internal" href="standard_stone.html">Standard stone localization module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitting_stone.html">Fitting stone localization module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ROS2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#camera-nodes-and-services">Camera Nodes and services</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-processing-node">Image Processing Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-idea-of-workflow">General idea of workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils function description (docstrings)</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation_blaze.html">Evaluation Basler Blaze 101</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Robot communication</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05_robot_communication/robot_communication.html">Required ROS2 Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_robot_communication/robot_communication.html#start-the-image-processing-in-simulation-mode">Start the image processing in simulation mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_robot_communication/robot_communication.html#start-the-image-processing-with-a-connected-robot">Start the image processing with a connected robot</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supplemental material</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_supplemental_material/gitlab_submodules.html">Gitlab Submodules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_supplemental_material/supplemental_material.html">Helpful links</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Image Processing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>ROS2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/04_image_processing_walkthrough/ros.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="ros2">
<h1>ROS2<a class="headerlink" href="#ros2" title="Permalink to this heading"></a></h1>
<hr class="docutils" />
<p>The communication between the different docker containers within the entire system of the “MauRob40” project is based on ROS2 Foxy.
ROS2 has multiple ways for communication. In this project the main way of communication is by services. To use a service, the node that provides the service (e.g. image_acquisition service) must be spun.
The service can be called by a client. The client sends a request to the service and receives a specified response.</p>
<div class="section" id="camera-nodes-and-services">
<h2>Camera Nodes and services<a class="headerlink" href="#camera-nodes-and-services" title="Permalink to this heading"></a></h2>
<p>To simplify the usage and development of further projects using either the helios2 or blaze101 camera, ROS2 drivers
have been written for both.</p>
<p>They both provide a service called <strong>acquire_image</strong> that relies on custom services contained in the <strong>image_processing_interfaces</strong> ros2 package.
The custom service is called <strong>PointcloudIntensity</strong>. It takes no input because it acts like a trigger for the camera and returns
both the pointcloud and the corresponding intensity values. The pointcloud is a array of type <strong>geometry_msgs/Point</strong> and the intensity values
an array of type <strong>float32</strong>.</p>
</div>
<hr class="docutils" />
<div class="section" id="image-processing-node">
<h2>Image Processing Node<a class="headerlink" href="#image-processing-node" title="Permalink to this heading"></a></h2>
<p>The developed image processing node provides two services. One service called <strong>locate_standard_stones</strong> and another service called <strong>locate_fitting_stones</strong>. They also rely on custom services defined in the <strong>image_processing_interfaces</strong> package.</p>
<p><strong>locate_standard_stones</strong> takes a pointcloud as described earlier as an input, runs the image processing algorithm and returns an array of 6D poses as
ros2 standard msg <strong>geometry_msgs/Pose</strong>. It’s the 6D poses of all located stones relative to the camera.</p>
<p>Same thing applies for the <strong>locate_fitting_stones</strong> service, only that it also requires the intensity_values as input.</p>
</div>
<hr class="docutils" />
<div class="section" id="general-idea-of-workflow">
<h2>General idea of workflow<a class="headerlink" href="#general-idea-of-workflow" title="Permalink to this heading"></a></h2>
<p>The general idea of the workflow is the following:</p>
<ol class="arabic simple">
<li><p>Start up all necessary ros nodes</p></li>
</ol>
<p>CAMERA:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run blaze101_driver blaze101
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run helios2_driver helios2
</pre></div>
</div>
<p>depending on the camera you want to use.</p>
<p>IMAGE PROCESSING:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run image_processing image_processing_service_node
</pre></div>
</div>
<p>All required services are now up and running.</p>
<ol class="arabic simple" start="2">
<li><p>Run the example client provided in the project. This has later to be implemented correctly by the coordinator.</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run image_processing locate_standard_stones
</pre></div>
</div>
<p>This will read a pointcloud from saved images and request a stone position from the <strong>locate_standard_stone</strong> service.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fitting_stone.html" class="btn btn-neutral float-left" title="Fitting stone localization module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="utils.html" class="btn btn-neutral float-right" title="Utils function description (docstrings)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Max Körner, Jonathan Sautter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>